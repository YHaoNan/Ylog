---
title: VIM中被我忽略的技巧(移动篇)
date: 2019-11-12 11:50:27
tags: [vim]
categories: Vim
---

已经使用Vim有几个月了，现在我已经到了没有VIM就不会打字的处境了。

不过VIM中有很多我曾经忽略的快捷键，其实这些快捷键挺常用的，就是不知道我当时怎么就不会用。导致在一些输入场景下很蛋疼。

## 行与屏幕行
VIM中有行和屏幕行之分。

当设置了`wrap`的时候，如果一行放不下就会折行显示，但这个折行在VIM中并不算一个实际行，所以当你用`j k`等动作按键移动时就会直接移动到很远的位置。VIM提供了屏幕行的概念，将动作命令前面加上`g`就是对屏幕行操作。

`gj` -- 向上移动一个屏幕行  
`gk` -- 向下移动一个屏幕行

## e和ge
总用w和b，忽略了e和ge。有时候想在单词尾部追加，这就很蛋疼了。

`e` -- 跳转到当前/下一个单词尾部。  
`ge` -- 跳转到上一个单词尾部。

## 单词和字串
字串只以空格分割，单词可能以标点分割。

```
we're niubility.
```

对于上一句，会被分成两个字串但会被分成五个单词。

大写的单词操作命令就是针对字串操作。

## ;
重度依赖`f`查找命令，这是个在单行快速跳转的好办法。因为我的vim安装了一个`f`按键的增强插件，如果一行中有多个搜索结果，再次按f就可以跳转到下一个结果位置。

但我忽略了vim还有个和f配套的按键`;`，他就是重复上次的f命令，寻找下一个匹配的字母。

```
Find the first occurrence of {char} and move to it.
```

比如从上面这行找`occurrence`这个单词中的最后一个c。`fc;;`貌似是个好办法。

## ,
如果你按`;`过了头，按`,`可以反方向查找上次的内容。


## t
`t`和`f`功能相同，都是在一行内查找指定字符。但是`f`是查找到那个字符，`t`是查找到前一个字符。

比如：
```
I've been expecting you, Mister Bond.
```
我们想把逗号后面的半句删除。

`f,dt.`

先用`f,`定位到逗号，再用`dt.`删除，不过这个操作会保留句尾的点。而用`f`就会删除句尾的点。

这个需求经常见到。

## 查找命令

`/xx<CR>`查找。`n`向下一个，`N`向上一个。

`d/xx`会删除查找到的单词之前的所有内容。
```
This phrase takes time but eventually gets to the point.
```

从行首执行`d/ge`会删除到`ge`之前的所有字符，结果是：
```
gets to the point.
```


## 文本对象

如果在圆括号内部，输入`vib`试试会发生什么？

圆括号中的内容会被选中。`vab`呢？圆括号内的内容包括圆括号都会被选中。

拆分这个命令，`v`是可视动作，`ib`和`ab`是操作对象，`b`即小括号，`i`可以看做`inside`，即只选中小括号内的文本，`a`看做`around`，即选中文本外还要选中包裹它的小括号。

VIM提供了很多文本对象。

```
b或) -- 小括号
B或} -- 大括号
] -- 中括号
> -- 尖括号
' -- 单引号
" -- 双引号
` -- 反引号
t -- xml标签
```

可以使用`动作+a/i+文本对象`的方式操作它们，比如`dit`删除所在xml标签里所有内容。

## 文本块对象

```
w -- 当前单词
W -- 当前字串
s -- 当前句子
p -- 当前段落
```
当对单词字串和句子应用a选取时，比如`daw`，会删除一个单词外加一个空格。

对段落时则是空行。

## 标记
VIM中一个一直被我忽略的强大功能就是标记。

VIM中用反引号\`代表在标记中跳转的动作命令。如下是一些VIM中自带的标记。

位置标记|跳转到
\`\`|当前文件中上次跳转动作之前的位置
\`.|上次修改的地方
\`^|上次插入的地方
\`[|上次修改或复制的起始位置
\`]|上次修改或复制的结束位置
\`<|上次高亮选区的起始位置
\`>|上次高亮选区的结束位置

除了这些自带的位置标记以外，VIM还可以允许你手动设置位置标记。

`mm`允许你设置标记，使用\`m就可以跳转到刚刚设置的标记处。

## 括号匹配
```
`%`允许我们在匹配的括号间跳转。

cities = %w{London Berlin New\ York}

如上是一段Ruby代码，我们现在想把这个`cites`改为普通的列表，即`["London","Berlin","New York"]`。

假设我们现在在等号后面，我们可以使用如下命令dt{%r]\`\`r[来实现。

首先用`dt{`而不是`df{`的原因是如果我们删除了`{`，我们就无法快速跳转到后面与它匹配的大括号了

然后就是%跳转到后面的大括号，用r]替换成中括号，再用\`\`跳转到上一次跳转动作的位置。也就是前面的大括号，再用`r[`替换它。
```
