<html><head><title>xargs和tr</title></head><body><h2>xargs</h2>

<p>xargs是一个把stdin转换成参数列表的工具。</p>

<p>比如有如下一个文件<code>args</code>：</p>

<pre><code>arg1
arg2
arg3
</code></pre>

<p>你想把其中每一行都输出一次（而不是一次全部输出），那么xargs就派上了用场。</p>

<pre><code class="language-bash">cat args | xargs -n 1 echo
</code></pre>

<p>xargs指定了一个<code>-n</code>参数，意思是每一个参数执行一次，上面的示例中xargs会把文件内容根据回车分割成三份，并把每一份交给echo命令执行一次。</p>

<p>最终的结果为：</p>

<pre><code>arg1
arg2
arg3
</code></pre>

<p>虽然这看起来和直接cat没有区别，但是本质上它们是不一样的。</p>

<p>把上面的命令稍微修改一下：</p>

<pre><code class="language-bash">cat args | xargs -n 2 echo
</code></pre>

<p>输出的结果是这样的：</p>

<pre><code>arg1 arg2
arg3
</code></pre>

<p>显然，xargs一次给echo命令提交了两个参数。</p>

<h3>指定分隔符</h3>

<p>默认的分隔符可能是回车，可能是空格，可能是<code>\0</code>。但是很多时候我们需要自己指定。比如：</p>

<pre><code class="language-bash">cat /etc/passwd | xargs -n 1
</code></pre>

<p>上面的代码通过xargs输出<code>/etc/passwd</code>的每一行，这个文件熟悉Linux的应该都知道，每一行是用<code>:</code>分割的。我们用xargs来分割它。</p>

<p>xargs用<code>-d</code>参数指定分隔符：</p>

<pre><code class="language-bash">cat /etc/passwd | xargs -n 1 | xargs -n 1 -d :
</code></pre>

<h3>指定参数位置</h3>

<p>假如我们需要编写如下功能，输出每一个参数的前后加上<code>@</code>，也就是说xargs需要把参数放到中间，xargs提供了占位符功能实现这一需求。</p>

<pre><code class="language-bash">cat args | xargs -I {} echo @ {} @
</code></pre>

<p>输出：</p>

<pre><code>@ arg1 @
@ arg2 @
@ arg3 @
</code></pre>

<h3>结合find</h3>

<pre><code class="language-bash">find . -type f -name &#39;*.txt&#39; -print0 | xargs -0 rm -f
</code></pre>

<p>如上命令删除当前目录下所有txt文件。<code>-print0</code>是用<code>\0</code>分割，而xargs的<code>-0</code>参数也是将分隔符设置成<code>\0</code>。一定不要设置简单的分隔符，或使用默认的，这样可能会误删文件。</p>

<pre><code class="language-bash">find ~/source/gesture4book/app/src/main/ -type f -regex &#39;.*\.\(java\|xml\)$&#39; | xargs wc -l
</code></pre>

<p>如上命令统计某个项目下的代码行数。</p>

<h3>循环和xargs</h3>

<p>xargs不能执行多条语句，而循环可以，所以有的时候用循环也不失为一个好办法。</p>

<pre><code class="language-bash">cat args | ( while read arg; do echo $arg; done )
</code></pre>

<h2>tr</h2>

<p>tr用于文本转换，将一个字符串转换成另一个字符串。</p>

<h3>大小写转换</h3>

<pre><code class="language-bash">cat args | tr &#39;a-z&#39; &#39;A-Z&#39;
</code></pre>

<p>输出:</p>

<pre><code>ARG1
ARG2
ARG3
</code></pre>

<h3>ROT13</h3>

<p>ROT13是一种简单的加密方法，通过把所有字母后移13位，比如a变成n。</p>

<pre><code>echo &#34;Yahoo~&#34; | tr &#39;a-zA-Z&#39; &#39;n-za-mN-ZA-M&#39;
</code></pre>

<p>输出：</p>

<pre><code>Lnubb~
</code></pre>

<h3>删除指定字符集</h3>

<p>比如我们的输入中有些无关紧要的数字：</p>

<pre><code>echo &#39;Hello12,Wo1r34ld34!12&#39;
</code></pre>

<p>我们想通过tr删除掉：</p>

<pre><code class="language-bash">echo &#39;Hello12,Wo1r34ld34!12&#39; | tr -d [0-9]
</code></pre>

<p>输出：</p>

<pre><code>Hello,World!
</code></pre>

<p>除了<code>-d</code>删除，也可以用补集的方式：</p>

<pre><code class="language-bash">echo &#39;Hello12,Wo1r34ld34!12&#39; | tr -d -c [0-9]
</code></pre>

<p>这样的话就只会留下数字。</p>

<pre><code>echo &#39;Hello12,Wo1r34ld34!12&#39; | tr -c [0-9] &#39; &#39;
</code></pre>

<p>这样的话会把所有不在集合1里的字符替换成空格。结果：</p>

<pre><code class="language-bash">     12   1 34  34 12 
</code></pre>

<h3>去除多余字符</h3>

<p>刚刚我们利用补集把所有非数字变成了空格，但是这样参差不齐的空格有点丑，我们想只留下一个。</p>

<pre><code class="language-bash">echo &#39;Hello12,Wo1r34ld34!12&#39; | tr -c [0-9] &#39; &#39; | tr -s &#39; &#39;
</code></pre>

<p><code>-s</code>在遇到多个指定字符连续排列时，会只留下一个指定字符，删除多余的。常用来删除多余空格和换行符。</p>

<h3>计算总和</h3>

<p>假设我们有这样一个文本<code>nums</code>：</p>

<pre><code class="language-bash">frist 1
second 2
third 3
</code></pre>

<p>我们想把所有的数字加起来：</p>

<pre><code class="language-bash">cat nums | tr -d [a-z] | echo &#34;total: $[ $( tr &#39; &#39; &#39;+&#39;  ) ]&#34;
</code></pre>
</body></html>